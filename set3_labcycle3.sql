CREATE DATABASE SAMPLE
USE SAMPLE
CREATE TABLE EMPLOYEE
(
SSN INT,
ENAME VARCHAR(40) NOT NULL,
DESIGN VARCHAR(20),
DNO INT,
DOJ DATE,
SALARY INT,PRIMARY KEY (SSN)
);
CREATE TABLE DEPARTMENT
(DNUMBER INT,
DNAME VARCHAR(20),
LOC VARCHAR(40),
MGRSSN INT REFERENCES EMPLOYEE(SSN),
PRIMARY KEY(DNUMBER)
);
 CREATE TABLE PROJECT
(
PNUMBER INT,
PNAME VARCHAR(15),
DNUM INT,
FOREIGN KEY(DNUM) REFERENCES DEPARTMENT(DNUMBER),
PRIMARY KEY(PNUMBER)
);
 CREATE TABLE WORK_IN
(
ESSN INT,
PNO INT,
HOURS INT,
FOREIGN KEY (ESSN)
REFERENCES EMPLOYEE(SSN),
FOREIGN KEY (PNO) REFERENCES PROJECT(PNUMBER),
FOREIGN KEY (HOURS) REFERENCES DEPARTMENT(DNUMBER)
);
DESCRIBE EMPLOYEE;
DESCRIBE DEPARTMENT;
DESCRIBE PROJECT;
INSERT INTO EMPLOYEE(SSN,ENAME,DESIGN,DNO,DOJ,SALARY)VALUES(1,'ALEN','HR',2,'2008-06-22',69000 ),
(2,'BOBAN','admin',1,'2009-04-20',71000 ),(3,'DIAZ','sales',3,'2013-07-03',65000 ),
(4,'JOMON','production',5,'2016-09-01',55000 ),(5,'MANU','marketing',5,'2014-09-02',55000 ),
(6,'NERIL','finance',4,'2010-01-19',51000 ),(7,'PRAVEEN','IT',2,'2011-12-31',46000 ),
(8,'SAM','finance',4,'2011-09-11',39000 );
SELECT * FROM EMPLOYEE;
INSERT INTO DEPARTMENT(DNUMBER,DNAME,LOC)VALUES(1,'Admin','kochi'),(2,'HR','Banglore'),
(3,'Sales','Kottayam'),(4,'Finance','kollam'),(5,'Production','Trivandrum');
SELECT * FROM DEPARTMENT;
INSERT INTO PROJECT(PNUMBER,PNAME,DNUM)VALUES(11,'Bancs',3),(12,'Nielesan',5),
(13,'WorldBank',1),(14,'Airlines',2),(15,'Amex',4);

UPDATE DEPARTMENT SET MGRSSN=2 WHERE DNUMBER=1;
UPDATE DEPARTMENT SET MGRSSN=1 WHERE DNUMBER=2; 
UPDATE DEPARTMENT SET MGRSSN=3 WHERE DNUMBER=3; 
UPDATE DEPARTMENT SET MGRSSN=6 WHERE DNUMBER=4; 
UPDATE DEPARTMENT SET MGRSSN=7 WHERE DNUMBER=2;
UPDATE DEPARTMENT SET MGRSSN=4 WHERE DNUMBER=5; 
UPDATE DEPARTMENT SET MGRSSN=5 WHERE DNUMBER=5;
SELECT * FROM PROJECT;
INSERT INTO WORK_IN(ESSN,PNO,HOURS)VALUES(1,14,NULL),(4,13,NULL),(8,12,NULL),
(6,15,NULL),(2,11,NULL),(3,13,NULL);
SELECT * FROM WORK_IN;
SELECT e.ENAME FROM EMPLOYEE e LEFT OUTER JOIN DEPARTMENT d on d.DNUMBER=e.DNO
WHERE e.SALARY BETWEEN 30000 AND 40000 AND d.DNUMBER=5;
SELECT e.ENAME,d.DNAME FROM EMPLOYEE e LEFT OUTER JOIN DEPARTMENT d on e.DNO=d.DNUMBER
ORDER BY d.DNAME ASC,e.ENAME ASC;
SELECT p.PNUMBER,p.PNAME,count(e.SSN) FROM WORK_IN w LEFT OUTER JOIN PROJECT p on
w.PNO=p.PNUMBER LEFT OUTER JOIN EMPLOYEE e on w.ESSN=e.SSN GROUP BY
p.PNAME,p.PNUMBER;
SELECT p.PNUMBER,p.PNAME,count(e.SSN) FROM WORK_IN w LEFT OUTER JOIN PROJECT p on
w.PNO=p.PNUMBER LEFT OUTER JOIN EMPLOYEE e on w.ESSN=e.SSN GROUP BY
p.PNAME,p.PNUMBER HAVING count(e.SSN) > 2;
SELECT p.PNUMBER,p.PNAME,d.DNUMBER,count(e.ssn) FROM PROJECT p LEFT OUTER JOIN
DEPARTMENT d on d.DNUMBER=p.DNUM LEFT OUTER JOIN EMPLOYEE e on e.DNO=p.DNUM
GROUP BY p.PNAME,p.PNUMBER,d.DNUMBER HAVING d.DNUMBER=5;
SELECT d.dname,d.dnumber,e.ssn,e.ename,e.design,e.doj,e.salary FROM department d,employee e WHERE  (SELECT COUNT(*) FROM employee e WHERE e.dno = d.dnumber AND e.salary> 40000) > 4 AND 
e.dno=d.dnumber GROUP BY d.dname,d.dnumber,e.ssn,e.ename,e.design,e.doj,e.salary;
create VIEW emp_dept_view as select  * from EMPLOYEE NATURAL JOIN department;
CREATE SYNONYM FROM EMP_dept_view;
SELECT * FROM EMP_DEPT;
SELECT * From EMPLOYEE e,DEPARTMENT d WHERE e.DNO=d.DNUMBER;
SELECT * FROM EMPLOYEE e,DEPARTMENT d WHERE NOT(e.DNO=d.DNUMBER);
SELECT * FROM EMPLOYEE e LEFT OUTER JOIN DEPARTMENT d ON e.DNO=d.DNUMBER; 
SELECT * FROM EMPLOYEE e RIGHT OUTER JOIN DEPARTMENT d ON e.DNO=d.DNUMBER; 
SELECT * FROM EMPLOYEE e INNER JOIN DEPARTMENT d ON e.DNO=d.DNUMBER;